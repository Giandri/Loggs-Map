generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model CoffeeShop {
  id              String   @id @default(cuid())
  name            String
  address         String
  lat             Float
  lng             Float
  whatsapp        String?
  instagram       String?
  facilities      Json     // JSON array
  photos          Json     // JSON array
  logo            String?  // Logo URL
  wfc             Boolean  @default(false)
  openTime        String?  // Jam buka (e.g. "08:00")
  closeTime       String?  // Jam tutup (e.g. "22:00")
  operatingDays   String?  // Hari operasional (e.g. "Everyday", "Senin - Sabtu")
  priceRange      String?  // Range harga (e.g. "Start From 20K")
  serviceTax      String?  // Service/Tax (e.g. "15.5%", "No Tax")
  connectionSpeed String?  // Kecepatan internet (e.g. "30 Mbps", "Good")
  mushola         Boolean  @default(false)
  parking         Json?    // JSON array ["motorcycle", "car"]
  paymentMethods  Json?    // JSON array ["cash", "qris", "debit"]
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Relations
  favorites       Favorite[]
}

model Favorite {
  id            String     @id @default(cuid())
  userId        String     // User identifier (session ID or device ID)
  coffeeShopId  String
  createdAt     DateTime   @default(now())

  // Relations
  coffeeShop    CoffeeShop @relation(fields: [coffeeShopId], references: [id], onDelete: Cascade)

  // Unique constraint to prevent duplicate favorites
  @@unique([userId, coffeeShopId])
}
